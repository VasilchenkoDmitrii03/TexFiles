\documentclass[9pt, a4paper]{extarticle}

\usepackage[russian]{babel}
\usepackage{amsfonts, amssymb, amsmath, mathabx, dsfont}

% theorems, lemmas, etc.
\usepackage{amsthm}
\newtheorem*{theorem*}{Теорема}
\newtheorem*{theorem}{Теорема}
\newtheorem*{lemma}{Лемма}
\newtheorem*{corollary}{Следствие}
\newtheorem*{notabene}{Замечание}
\newtheorem*{definition}{Определение}
\newtheorem*{sample}{Пример}

% enumerating settings
\DeclareMathOperator*\lowlim{\underline{lim}}
\DeclareMathOperator*\uplim{\overline{lim}}

\usepackage[left=30mm, top=20mm, right=15mm, bottom=20mm, nohead, footskip=10mm]{geometry}
\title{Методы оптимизации}
\date{}
\begin{document}
	\maketitle
	\section{Теорема Вейерштрасса (метрический вариант).}
	Задача: Минимизировать функционал $J(u)$ по множеству $U \subset X$, $X - \text{метрическое}$. \newline
	$J_* = \inf\limits_{u \in U} J(u)$, $J(u_*) = J_*$, $U_* = \{u \in U \vert J(u) = J_*\}$
	\begin{definition}
		Функционал $J(u)$ на $U$ называется полунепревным снизу (сверху), если $\forall {u_n} \subset U: \ \rho(u_n, u_0) \to 0  \Rightarrow$ $J(u_0) \leq \lowlim_{n\to\infty} J(u_n)$ $\left( J(u_0) \geq \uplim_{n\to\infty}J(u_n)\right)$
	\end{definition}
	\begin{definition}
		Последовательность $\{u_n\} \subset U$ называется минимизирующей, если $\exists J(u_n) \to J_*$
	\end{definition}
	\begin{definition}
		Последовательность $\{u_n\} \subset U$ сходится к множеству $K \subset U$, если $\inf\limits_{u \in K} \rho(u_n, u) \to 0$
	\end{definition}
	\begin{theorem}
		(Теорема Вейерштрасса метрический вариант)\newline
		 Пусть $U$ - компкатное множество, $J(u)$ - полунепрервный снизу, тогда 
		 \begin{enumerate}
		 	\item $J_* > -\infty$
		 	\item $U_*$ - непустое компактное множество
		 	\item Любая минимизирующая последовательность $\{u_n\}$ сходится к $U_*$
		 \end{enumerate}
	\end{theorem}
\section{Слабый вариант теоремы Вейерштрасса. Применение к задаче минимазции квадратичного функционала.}	
	$H$ - гильбертово пространство.
	\begin{definition}
	Функционал $J(u)$ на $U$ называется слабо полунепревным снизу (сверху), если $\forall {u_n} \subset U: \ u_n \rightharpoondown u_0  \Rightarrow$ $J(u_0) \leq \lowlim_{n\to\infty} J(u_n)$ $\left( J(u_0) \geq \uplim_{n\to\infty}J(u_n)\right)$
	\end{definition}
	\begin{notabene}
		Из слабой полунепрервыности следует сильная полунепрерывность
	\end{notabene}
	\begin{definition}
		Последовательность $\{u_n\} \subset H$ слабо сходится к множеству $K \subset H$, если любая слабая предельная точка $\{u_n\}$ принадлежит $K$.
	\end{definition}
	\begin{definition}
		Множество $U \in H$ называется выпуклым, если $\forall u, v \in U, \ \forall \alpha \in [0,1]: \alpha u + (1-\alpha) v \in U$. 
	\end{definition}
	\begin{definition}
		Функционал $J(u)$ называется выпуклым на выпуклом $U$, если $\forall u, v \in U, \ \forall \alpha \in [0,1]: \ J(\alpha u + (1-\alpha)v) \leq \alpha J(u) + (1-\alpha) J(v)$.
	\end{definition}
	\begin{lemma}
		Пусть $U$ - выпуклое замкнутое ограниченное множество, тогда $U$ - слабокомпактное множество. 
	\end{lemma}
	\begin{lemma}
		Пусть $J(U)$ полунепрерывный снизу и выпуклый на $U$, тогда он слабо полунепрерывный снизу.
	\end{lemma}
	\begin{theorem*}
	(Слабый вариант теоремы Вейерштрасса)\newline
	Пусть $U \subset X$ - замкнутое ограниченное выпуклое множество, $J(u)$ - выпуклый и полунепрерывный на $U$, тогда 
	\begin{enumerate}
		\item $J_* > -\infty$
		\item $U_*$ - непустое замкнутое ограниченное выпуклое множество
		\item Любая минимизирующая последовательность $\{u_n\}$ слабо сходится к $U_*$
	\end{enumerate}
	\end{theorem*}
	\subsection*{Квадратичный функционал}
	Функионал $J(u) = \|Au - f\|_F^2$, $A: H \to F$ - линейный ограниченный оператор, $f \in F$. Исследуем его свойства:
	\begin{enumerate}
		\item $J(u)$ непрерывный в силу непрерывности A и непрерывности нормы.
		\item Проверим выпуклость $J(u)$: $J(\alpha u + (1-\alpha) v) = \|A\left(\alpha u + (1-\alpha) v\right) - f\|^2 = \|\alpha(Au - f) + (1 - \alpha) (Av - f) \|^2 \leq$ \newline
		$\leq \left(\|\alpha(Au - f)\| + \|(1 - \alpha) (Av - f) \| \right)^2 \leq \{x^2 \text{выпукла}\} \leq |\alpha| \|(Au - f)\|^2 + |1 - \alpha| \| Av - f\|^2$
		\item Полунепрерывный снизу
		\item В общем случае не является слабо полунепрерывным т.к. если $A = I, f = 0$, то на последовательности ортонормированных векторов слабой сходимости не будет.
		\item Слабо полунепрерывен снизу, т.к. полунепрерывен снизу и выпуклый.
	\end{enumerate}
\section{Существование решения задач минимизации терминального и интегрального квадратичных функционалов на решениях линейной системы ОДУ }
	Рассматриваем задачу
	\begin{equation*}
		\begin{cases}
			\dot{x}(t) = D(t) x(t) + B(t) u(t) + y(t), \ t \in (0, T) \\ 
			x(0) = x_0
		\end{cases}
	\end{equation*}
	$u(t)$ - функция управления \newline
	Размерности: $x(t): n\times 1, \ D(t): n \times n, \ B(t) : n \times r, \ u(t): r\times 1, \ y(t): n \times 1$ \newline
	Базово предполагаем, что $D(t), B(t) \in L_\infty(0,T); \ u \in L_2(0,T); \ x_0 \in \mathbb{R}^n$\newline
	Надо найти пару $x(t) \in AC[0,T], u(t) \in L_2(0,T)$. $AC$ - абослютная непревность: 1) п.в. на $[0,T]$ существует производная; 2) верна формула Ньютона-Лейбница
	\begin{definition}
		Решением Задачи Коши по Каратеодори называется функция $x(t) \in AC[0,1]$ такая, что уравнение выполняется п.в., а граничное условие выполняется в классическом смысле. 
	\end{definition}
	\begin{definition}
		Альтернативным решением называется функция $x(t) \in AC[0,1]$ такая, что выполняется интегральное соотношение: $x(t) = x_0 + \int\limits_0^t \left[D(t) x(t) + B(t) u(t) + y(t)\right] dt,\  \forall t \in [0,T]$
	\end{definition}
	\begin{theorem}
		Пусть $D(t), B(t) \in L_\infty(0,T), \ u, y(t) \in L_2(0,T)$ тогда существует и единственно решение Задачи Коши. 
	\end{theorem}
	\begin{theorem}
		(о существовании решения задачи ОУ линейной системы)\newline
			Пусть $D(t), B(t) \in L_\infty(0,T)$, U - слабый компакт, тогда 
					 \begin{enumerate}
				\item $J_* > -\infty$
				\item $U_* \neq \emptyset$
				\item Любая минимизирующая последовательность $\{u_n\}$ слабо в $L_2(0,T)$ сходится к $U_*$
			\end{enumerate}
	\end{theorem}
\section{Существование реения задачи об оптимальном нагреве стержня}
	Рассматривается задача:
	\begin{equation*}
		\begin{cases}
			y_t = y_{xx} , x \in (0, l), t \in (0, t)\\
			y_x\vert_{x=0} = 0 \\
			y_x + y\vert_{x = l} = u(t) \\
			y\vert_{t=0} = 0
		\end{cases}
	\end{equation*}
	Решение: $y = y(t; x)$. Рассмотрим функционал $J(u) = \int\limits_0^l \left(y(T, x, u) - f(x)\right)^2 dx$. Значение именно в $t = T$, то есть в конце процессса. Минимизируем этот функционал. По сути $y(T, x, u) = Au$, тогда $J(u) = \|Au - f\|_{L_2(0,l)}^2$.\newline
	Пусть $y(t, x)$ - дважды гладкая функция, а $U$ - замкнутое ограниченное выпуклое множество. 
	\begin{theorem}
		(о существовании решения обратной задачи)\newline
		Пусть $U$ - слабый компакт в $L_2(0,T)$, тогда 
		\begin{enumerate}
			\item $J_* > \infty$
			\item $U_* \neq \emptyset$
			\item Любая минимизирующая последовательность слабо сходится к $U_*$  в $L_2(0,T)$. 
		\end{enumerate}
	\end{theorem}
\section{Дифференцирование по Фреше. Применение к квадратичному функционалу}
	Пусть $F: X \to Y$, $X,Y$ - банаховы.
	\begin{definition}
		Оператор $A:X \to Y$ называется производной по Фреше оператора $F$ в т. $x \in X$, если $F(x+h) - F(x) = Ah + \overline{o}(\|h\|_X)$ при $\|h\|_X \to 0$
	\end{definition}
	\begin{lemma}
		Производная по Фреше определяется единственным образом
	\end{lemma}
	\begin{definition}
		Оператор $F''$ называется второй производной по Фреше от оператора $F$ в т. $x \in X$, если $F'(x+h) - F'(x) = F''h + \overline{o}(\|h\|_X)$ при $\|h\|_x \to 0$. 
	\end{definition}
	
	\begin{definition}
			Оператор $F$ дифференицируем на множестве $U \subset X$, если он определён на множестве $M: U \subset M$ и $\exists F'(u), \forall u \in U$. 
	\end{definition}
	\subsection*{Градиент и Гессиан}
	Рассматриваем Гильбертово пространство $H$
	\begin{definition}
		Функционал $F'$ называется градиентом функционала $F$, в т. $x \in H$, если $F(x + h) - F(x) = (F'(x), h) + \overline{o}(\|x\|_H)$
	\end{definition}
	\begin{definition}
		Функционал $F''(x)$ называется гессианом функционала $F$, в т. $x \in H$, если $F'(x + h) - F'(x) = F''(x)h + \overline{o}(\|x\|_H)$
	\end{definition}
	Найдем градиент и гессиан функционала $J(u) = \|Au - f\|_F^2$: \newline
	$J(u+h) - J(u) = \|A(u+h) - f\|^2 - \|Au - f\|^2 = \|(Au - f) + Ah\|^2 - \|Au - f\|^2 = \|Au - f\|^2 + \|Ah\|^2 + 2 (Au - f, Ah) - \|Au -f\|^2 = (Au - f, Ah) + \|Ah\|^2$. Покажем, что  $\|Ah\|^2 \leq \|A\|^2 \|h\|^2 = \underline{O}(\|h\|^2) = \overline{o}(\|h\|)$. \newline
	В итоге $J'(u) = 2 A^*(Au - f)$.\newline
	$J'(u+h) - J'(u) = 2A^*A h$ $\Rightarrow$ $J''(u) = 2A^*A$.
	
\section{Необходимое условие локального минимума}
	\begin{theorem*}
		Пусть $U$ - выпуклое множество в $H$, $u_* \in U$ -локальный минимум $J(u)$ на $U$ и существует $J'(u_*)$ $\Rightarrow$ $(J'(u_*), u - u_*) \geq 0, \ \forall u \in U$. 
	\end{theorem*}
	\begin{theorem*}
		Пусть $U$ - выпуклое множество в $H$, $u_* \in \text{int}U_*$ и  существует $J'(u_*)$ $\Rightarrow$ $(J'(u_*), u - u_*) = 0, \ \forall u \in U$. 
	\end{theorem*}
	\begin{sample}
		$J(u) = u$, $u \in [1,2] \subset \mathbb{R}$. Понятно, что $u_* = 1$, $J_* = 1$, $J'(u) = I, \Rightarrow (J'(u_*), u- u_*) = (1, u - 1) \geq 0$ т.к. $u \in [1,2]$.
	\end{sample}
	\begin{sample}
		Сложный и непонятный
		
	\end{sample}
\section{Градиент терминального граничного функционала}
	Рассматриваем задачу
	\begin{equation*}
		\begin{cases}
			\dot{x}(t) = D(t) x(t) + B(t) u(t), \ t \in (0, T) \\ 
			x(0) = 0
		\end{cases}
	\end{equation*}
	Рассматриваем оператор $Au(t) = x(t)$ - сопоставляет решение функции управления. Функционал $J(u) = \|Au- f\|^2$, $J'(u) = 2A^*(Au - f)$. Необходимо найти $A^*$, т.е. $(Au, v) = (u, A^*v)$\newline
	Домножим уравнение скалярно на $\psi(t)$ и проинтегрируем от 0 до T \newline
	\begin{math}
		\int\limits_0^T ( \psi(t), \dot{x}(t)) dt = \int\limits_0^T (\psi(t), D(t)x(t) + B(t)u(t)) dt \\
		(\psi(t), x(t))\vert_0^T  - \int\limits_0^T (\dot{\psi}(t), x(t)) dt= \int\limits_0^T (\psi(t), Au(t)) dt \\
		(\psi(T), x(T))- \int\limits_0^T (\dot{\psi}(t), x(t)) dt = \int\limits_0^T (\psi(t), Au(t)) dt , \  \text{Потребуем  $v(t) = \psi(t)$} \\
		(v, Au) = \int\limits_0^T (\dot{\psi}(t), x(t)) dt +  \int\limits_0^T (\psi(t), D(t)x(t) + B(t) u(t)) dt\\
		(v, Au) = \int\limits_0^T (\dot{\psi}(t), x(t)) dt +  \int\limits_0^T \left[ (D^T \psi(t), x(t)) + (B^T \psi(t), u(t)) \right] dt \\
		(v, Au) = \int\limits_0^T (\dot\psi(t) + D^T \psi(t), x(t)) dt + \int\limits_0^T (B^T(t)\psi(t), u(t))dt, \ \text{Потребуем $\dot\psi(t) + D^T \psi(t) = 0$}
	\end{math}
	\newline
	Тогда $(v, Au) = \int\limits_0^T (B^T(t)\psi(t), u(t))dt $$\Rightarrow  (A^*v)(t) = B^T(t) \psi(t)$.  $\psi(t)$ определяется из двойственной задачи. 
		\begin{equation*}
		\begin{cases}
			\dot\psi(t) = -D^T(t)\psi(t) \\
			\psi(t) = v(t)
		\end{cases}
	\end{equation*}
	
\section{Градиент интегрального квадратичного функционала}
	Рассматриваем задачу
	\begin{equation*}
		\begin{cases}
			\dot{x}(t) = D(t) x(t) + B(t) u(t), \ t \in (0, T) \\ 
			x(0) = 0
		\end{cases}
	\end{equation*}
	$J_I(u) = \int\limits_0^T |x(t; u) - f(x)|^2 dt$, $Au = x(t; u)$, $J_I(u) = \|Au - f\|_{L_2}^2$, $J_I' = 2A^*(Au - f)$. Надо искать  $A^*$\newline
	Нам подойдёт $A^* v = B^T \psi(t; v)$, где 
	\begin{equation*}
		\begin{cases}
			\dot{\psi}(t) = -D^T(t) \psi(t) -v(t), \ t \in (0, T) \\ 
			\psi(T) = 0
		\end{cases}
	\end{equation*}
	Проверим это:
	\begin{math}
		(Au, c)_{L_2} = \int\limits_0^T x(t;u) v(t) dt = \int\limits_0^T x(t; u) \left[-\dot{\psi}(t) - D^T(t) \psi(t)\right]dt = -\int\limits_0^T x(t;u)\dot{\psi}(t) dt - \int\limits_0^T x(t;u) D^T(t)\psi(t)dt = \\
		- x(t;u)\psi(t) \vert_{t=0}^{t=T} + \int\limits_0^T \dot{x}(t;u)\psi(t)dt - \int\limits_0^T x(t;u) D^T(t)\psi(t)dt = \int\limits_0^T\left[D(t) x(t) + B(t) u(t) \right]\psi(t) dt- \int\limits_0^T x(t;u) D^T(t)\psi(t)dt = \\
		=\int\limits_0^T B(t) \psi(t) u(t) dt = (u(t), B^T \psi)_{L_2}
	\end{math}
\section{Градиент функционала в задаче о нагреве стержня}
	Рассматриваем задачу
	\begin{equation*}
		\begin{cases}
			y_t = y_{xx} , x \in (0, l), t \in (0, t)\\
			y_x\vert_{x=0} = 0 \\
			y_x + y\vert_{x = l} = u(t) \\
			y\vert_{t=0} = 0
		\end{cases}
	\end{equation*}
	Рассмотрим Функционал $J(u) = \int\limits_0^l |y(T, x; u) - f(x)|^2 dx$, $Au = y(T, x; u)$ тогда $J(u) = \|Au - f\|_{L_2}^2$, $J'(u) = 2A^* (Au - f)$. Нужно найти $A*$.\newline
	Умножим уравнение на $\psi(t,x)$ и проитнегрируем по $Q = (0, T) \times (0,l)$. \newline
	\begin{math}
		\iint\limits_Q \left[y_{xx} - y_t\right] \psi dt dx = \int\limits_0^T \left[ \int\limits_0^l y_{xx} \psi dx\right] dt - \int\limits_0^l \left[\int\limits_0^T y_t \psi dt\right]dx = \{\text{По частям}\} = \int\limits_0^T\left[y_x\psi \vert_{x=0}^{x = l} - y\psi_x\vert_{x=0}^{x=l} + \int\limits_0^l y \psi_{xx} dx\right]dt - \int\limits_0^l \left[ y\psi \vert_{t=0}^{t=T} - \int\limits_0^T y \psi_t dt \right]dx =\int\limits_0^T y_x\psi \vert_{x=0}^{x = l} dt - \int\limits_0^T y\psi_x\vert_{x=0}^{x=l} dt - \int\limits_0^l  y\psi \vert_{t=0}^{t=T} dx + \iint\limits_Q y\left(\psi_{xx} + \psi_{t}\right) dt dx =  \\
		= \{\text{Требуем $\psi_{xx} + \psi_{t} = 0$ в Q и $\psi_x\vert_{x=0} = 0$, много что обнуляется из-за граничных условий} \} = \\
	    = \int\limits_0^T \left[y_x(t, l)\psi(t,l)  \right] dt  - \int\limits_0^T y(t, l) \psi_x(t, l) dt - \int\limits_0^l \left[y(T, x)\psi(T,x)\right] dx = \int\limits_0^T \left[u(t) - y(t,l) \right] \psi(t,l) dt  - \int\limits_0^T y(t, l) \psi_x(t, l) dt - (Au, v)_{L_2} = \\
	   	= (u, \psi \vert_{x=l})_{L_2} - \int\limits_0^T \left[\psi(t,l) + \psi_x(t,l)\right] y(t,l)dt - (Au, v)_{L_2} = \{\text{Потребовали, чтобы $\psi(T,x) = v(x)$ и $(\psi_x + \psi) \vert_{x=l}= 0$}\} = \\
	   	=  (u, \psi \vert_{x=l})_{L_2}  - (Au, v)_{L_2} = 0
	\end{math}\newline
	Получили, что $A^*v = \psi\vert_{x=l}$, где 
		\begin{equation*}
		\begin{cases}
			\psi_t = -\psi_{xx} , x \in (0, l), t \in (0, t)\\
			\psi_x\vert_{x=0} = 0 \\
			\psi_x + \psi\vert_{x = l} = 0 \\
			\psi\vert_{t=T} = v
		\end{cases}
	\end{equation*}
\section{Выпуклые функции и функционалы. Теоремы о локальном минимимуме, о множестве Лебега, о касательной плоскости. Критерий оптимальности. Примеры}
	\begin{definition}
		Множество $U \in H$ называется выпуклым, если $\forall u, v \in U, \ \forall \alpha \in [0,1]: \alpha u + (1-\alpha) v \in U$. 
	\end{definition}
	\begin{definition}
		Функционал $J(u)$ называется строго выпуклым на выпуклом $U$, если $\forall u, v \in U, \ \forall \alpha \in [0,1]: \ J(\alpha u + (1-\alpha)v) <  \alpha J(u) + (1-\alpha) J(v)$.
	\end{definition}
	\begin{definition}
		Функционал $J(u)$ называется сильно выпуклым на выпуклом $U$ с константой $\ae > 0$, если $\forall u, v \in U, \ \forall \alpha \in [0,1]: \ J(\alpha u + (1-\alpha)v) \leq  \alpha J(u) + (1-\alpha) J(v) - \dfrac\ae2 \alpha(1-\alpha) \|u-v\|^2$.
	\end{definition}
	\begin{sample}
		Функционал $J(u) = \|Au - f\|$ является выпуклым.
	\end{sample}
	Свойства строгой выпуклости:
	\begin{enumerate}
		\item $J_1(u), J_2(u)$ - строго выпуклы на $U$ и $\alpha_1, \alpha_2 >0$ $\Rightarrow$ $\alpha_1 J_1(u) + \alpha_2 J_2(u)$ строго выпулый на $U$. 
		\item $J_1(u)$ - строго выпуклый, $J_2(u)$ - выпуклый на $U$ $\Rightarrow$ $J_1(u) + J_2(u)$ - строго выпуклый на $U$. 
	\end{enumerate}
	\begin{theorem}
		(о локальном минимуме)\newline
		$J(u)$ - выпуклый на $U$ $\Rightarrow$ точка локального минимума - точка глобального минимума.
	\end{theorem}
	\begin{theorem}
		(о множестве Лебега)\newline
		$J(u)$ - выпуклый на $U$ $\Rightarrow$ множество $L_c = \{u \in U \vert J(u) \leq c\}$ - замкнуто $\forall c \in \mathbb{R}$. 
	\end{theorem}
	Обратное неверно т.к. $J(u) = u^3, \ u\in \mathbb{R}, \ L_c = (-\infty, \sqrt[3]{c}]$
	\begin{lemma}
		Пусть $U$ - выпуклое, $J(u)$ - выпуклый на $U$, тогда $U_*$ - замкнуто.
	\end{lemma}
	\begin{lemma}
			Пусть $U$ - выпуклое, $J(u)$ - строго выпуклый на $U$, тогда $U_*$ содержит одну точку или $U_* = \emptyset$.
	\end{lemma}
	\begin{sample}
		$U_* = \emptyset$: \newline
		\begin{enumerate}
			\item $J(u) = u, \ u \in \mathbb{R} \Rightarrow J_* = - \infty, U_* = \emptyset$.
			\item $J(u) = e^{-u}, \ u \in \mathbb{R} \Rightarrow J_* = 0, U_* = \emptyset$.
		\end{enumerate}
	\end{sample}
	\begin{theorem}
		(о касательной плоскости)\newline
		Пусть $U$ - выпуклое, $J(u)$ сильно выпуклый на $U$ c $\ae > 0$ и в точке $v$ $\exists J'(v)$ $\Rightarrow$ $J(u) \geq J(v) + (J'(v), u - v) + \dfrac\ae2 \|u-v\|^2, \forall u \in H$. 
	\end{theorem}
	\begin{theorem}
		(критерий оптимальности)\newline
		Пусть $U$ - выпуклое, $J(u)$ выпуклый на $U$ и $\exists J'(u_*)$ $\Rightarrow$ $u_* \in U_* \Leftrightarrow \text{выполнено } (J'(u_*), u -u_*) \geq 0, \forall u \in U$. 
	\end{theorem}
	\begin{sample}
		Решить уравнение $Au = f$, $A \in L(H \to H), A = A^*$. Эквивалентна задаче минизации функционала  $J(u) = (Au, u) - 2(u,f) \to min$. $J'(u_*) = 0, \ (A + A^*) u_* = 2f \Rightarrow Au_* = f$
	\end{sample}
\section{Критерий выпуклости функций и функционалов. Выпуклость квадртичного функционала}
	\begin{theorem}
		(критерий выпуклости)\newline
		Пусть $U$ - выпуклое, $J(u) \in C^1(U)$, тогда следующие утверждения эквивалентны
		\begin{enumerate}
			\item $J(u)$ выпуклый
			\item $J(u) > J(v) + (J'(v), u - v), \forall u,v \in U$
			\item $(J'(u) - J'(v), u-v) \geq 0, \forall u, v \in U$
		\end{enumerate}
	\end{theorem}
	Выпуклость квадратичного доказана в первом билете. 
\section{Сильно выпуклые функции и функционалы, их свойства. Критерии сильной выпуклости функций и функционалов}
	\begin{definition}
		Функционал $J(u)$ называется сильно выпуклым на выпуклом $U$ с константой $\ae > 0$, если $\forall u, v \in U, \ \forall \alpha \in [0,1]: \ J(\alpha u + (1-\alpha)v) \leq  \alpha J(u) + (1-\alpha) J(v) - \dfrac\ae2 \alpha(1-\alpha) \|u-v\|^2$.
	\end{definition}
		Свойства сильно выпуклости:
	\begin{enumerate}
		\item $J_1(u), J_2(u)$ - сильно выпуклы на $U$ и $\alpha_1, \alpha_2 >0$ $\Rightarrow$ $\alpha_1 J_1(u) + \alpha_2 J_2(u)$ сильно выпулый на $U$. 
		\item $J_1(u)$ - сильно выпуклый, $J_2(u)$ - выпуклый на $U$ $\Rightarrow$ $J_1(u) + J_2(u)$ - сильно выпуклый на $U$. 
	\end{enumerate}
	\begin{theorem}
		(критерий сильной выпуклости)\newline
		Пусть $U$ - выпукло, $J \in C^1(U)$, тогда $J(u)$ сильно выпуклый на $U$ с константой $\ae > 0$ $\Leftrightarrow$ $(J'(u) - J'(v), u -v) \geq \ae \|u - v\|^2, \forall u, v \in U$. 		
	\end{theorem}
	\begin{theorem*}
		(второй критерий сильной выпуклости)\newline
		Пусть $U$ - выпукло, $J \in C^2(U)$, $\text{int} U \neq \emptyset$, тогда $J(u)$ сильно выпуклый на $U$ с константой $\ae > 0$ $\Leftrightarrow$ $(J''(u)h, h)\geq \ae\|h\|, \forall u \in U, h \in H$.
	\end{theorem*}
	\begin{sample}
		$J(u) = \|u\|^2$, $J'(u) = 2u$, $J''(u)= 2I$, $(J''(u)h, h) =  2 \|h\|^2 \geq \ae \|h\|^2 \Rightarrow \ae = 2$ 
	\end{sample}
	\begin{sample}
		$J(u) = x^2 + 2xy + y^2 + z^2$, $u \in \mathbb{R}^3$.
		\begin{equation*}
			J''(u) = \left(\begin{matrix}
				2,2,0\\
				2,2,0\\
				0,0,2
			\end{matrix} \right)
		\end{equation*}
		Найдем собственные значения: $\lambda_1 = 0, \lambda_2 = 2, \lambda_3 = 4$. По критерию положительно опредленных матриц, все с.з. неотрицательны, значит матрица положительна определена: $(J''(u)h, h) \geq 0$. Но $J(u)$ не является сильно выпуклым т.к. при $\lambda_1$ значение ровно 0. 
	\end{sample}
	
\section{Теорема Вейерштрасса для сильно выпуклых функционалов}
	\begin{theorem}
		Пусть $U$ - выпуклое, замкнутое, $J(u)$ сильно выпуклый на $U$ с $\ae > 0$ и полунепрерывный снизу на $U$, тогда
		\begin{enumerate}
			\item $J_* > - \infty$
			\item $U_* = \{u_*\} \neq \emptyset$
			\item $\forall u \in U: \ \dfrac\ae2 \|u - u_*\|^2 \leq J(u) - J(u_*)$
		\end{enumerate}
	\end{theorem}
\section{Метрическая проекция точки на выпуклое замкнутое множество в гильбертовом пространстве, её свойства. Примеры}
	\begin{definition}
		Пусть $U \subset H$. Проекцией элемента $u \in H$ на множество $U$ называется $w \in U$: $\|w - u\| = \inf\limits_{v\in U} \|v - u\|$
	\end{definition}
	\begin{theorem}
		(существование и единственность и свойства проекции)\newline
		Пусть $U$ - выпуклое и замкнутое, тогда
		\begin{enumerate}
			\item $\forall u \in H \ \exists! w = P_uu$.
			\item $w = P_uu \Leftrightarrow (w-u, v- w) \geq 0, \forall v \in U$. 
		\end{enumerate}
	\end{theorem}
	\begin{theorem}
		(о нестрогой сжимаемости)\newline
		Пусть $U$ - выпуклое и замкнутое мноежство $\Rightarrow$  $\forall u, v \in H \ \ \|P_uu - P_uv\| \leq \|u - v\|$. 
	\end{theorem}
	\begin{sample}
		$U = B_R(0)$, $u \in H, w = P_uu$, $w = \begin{cases}
			u, u \in U \\
			\dfrac{u}{\|u\|}R, u \notin U
		\end{cases}		$. Проверим свойство: ссли $u \in U$ то очевидно, пусть $u \notin U$, тогда $(	\dfrac{u}{\|u\|}R - u, v - 	\dfrac{u}{\|u\|}R) = \left(\dfrac{R}{\|u\|} -1\right) (u, v - 	\dfrac{u}{\|u\|}R)$. Первое слагаемое неположительно, второе тоже т.к. $\|v\| \leq R$. Поэтому условие выполняется. 
	\end{sample}
	\begin{sample}
		$U = \{u \in L_2(a,b) \vert \alpha(t) \leq u(t) \leq \beta(t), \alpha(t), \beta(t) \in L_2(a,b)\}$,  $\|u(t) - h(t)\|_{L_2}^2 = \int\limits_a^b |u(t) - h(t)|^2 dt \to \inf$ \newline
		$P_Uh = \begin{cases}
			h(t), \alpha(t) \leq h(t) \leq \beta(t) \\
			\beta(t), \beta(t) \leq h(t) \\
			\alpha(t), h(t) \leq \alpha(t)
		\end{cases}$
	\end{sample}
	
\section{Градиентный метод. Метод проекции градиента. Их сходимость}
	Решаем задачу $J(u) \to \inf$ в гильбертовом пространстве. Многие методы решения укладываются в итерационную схему:
	\begin{equation}
		u_{k+1} = u_k + \alpha_k p_k
	\end{equation}
	$u_0$ - задано, $\alpha_k$ - шаг, $p_k$ - поправление шага. 
	\begin{enumerate}
		\item $p_k = -J'(u_k)$ - наискорейшее локальное убывание 
		\item $\alpha_k$ можно выбирать например так: $\alpha_k \in (\text{Argmin}_{\alpha \in \mathbb{R}} J(u_k + \alpha p_k))$
		\item $u_0$ хочется выбрать как можно ближе к $u_*$. 
		\item Правило останова: \begin{enumerate}
			\item малость градиента $\|J'(u_k)\| \leq \varepsilon$ -строгий
			\item $\dfrac{\|u_{k+1} -u_k \|}{\|u_k\|} \leq \varepsilon$ -слабый
			\item $\dfrac{|J(u_{k+1}) - J(u_k)|}{|J(u_k)|}\leq \varepsilon$ - самый слабый
		\end{enumerate}
	\end{enumerate}
	\subsection*{Градиентный метод}
		Его имеет смысл применять к задачам вида $J(u) \to \inf, \ u\in U\subset H, \ J(u) \in C^1(H)$\newline
		Представляет из себя итерационный процесс $u_{k+1} = u_k - \alpha_k J'(u_k), \ \alpha_k > 0, \ k = 0, 1, 2, \dots$
		Выбор длины шага можно делать по-разному:
		\begin{enumerate}
			\item константный шаг (проблемы: зацикливание, перескок)
			\item метод дробления: сначала задаем $\alpha_*$б потом $\alpha_k = \dfrac{\alpha_*}{2^m}, \ m = 0, 1, 2, \dots$. На каждом шаге проверяется будет ли $J(u_k - \dfrac{\alpha_*}{2^m}J'(u_k)) < J(u_k)$ и в качестве m берется первый, при котором выполняется это неравенство.
			\item метод скорейшего спуска: выбираем $\alpha$ для оптимального убывания.
		\end{enumerate}
		\begin{sample}
			$J(u) = \dfrac12 x^2 + \dfrac14 y^4 - \dfrac12 y^2 \to \inf, \ u \in \mathbb{R}^2$. Очевидно, что $J_* = - \dfrac14$, $U_* = \{(0,1), (0, -1)\}$. Решим с помощью градиентного метода: $J'(u) = (x, y^3 - y)$\newline
			$u_0 = (1, -1)$, $\alpha_k = \dfrac12$. $J'(u_0) = (1, 0)$ $u_1 = (\dfrac12 , -1)$, $u_2 = (\dfrac14 , -1), \dots, u_k = (2^{-k}, -1)$. 	
		\end{sample}
	\subsection*{Метод проекции градиента}
		Отличается тем, что теперь ищем оптимум не во всем пространстве, а на $U \neq H$. Тогда в какой-то момент значение функционала в точке, не принадлежащей множесту $U$ неопределено. Исправляем так:\newline
		$u_{k+1} = P_u(u_k - \alpha_k J'(u_k)), \ \alpha_k > 0, k =0, 1, 2, \dots$.
		\begin{theorem*}
			(о сходимост МПГ)\newline
			Пусть $U$ - выпуклое, замкнутое множество из $H$ и $J(u) \in C^1(U)$ и градиент $J(u)$ удовлетворяет условию Липшица с константой $L > 0$ на $U$. Пусть $J(u)$ сильно выпуклый на $U$ с константой $\ae >0$ и коэффициенты $\alpha_k  = \alpha \in (0, \dfrac{2\ae}{L^2})$. Тогда при $\forall$ начальном условии последовательность $u_k$ сходится к решению $u_*$ и справедлива оценка: $\|u_k-u_*\| \leq q^k\|u_0 - u_*\|, \ q = \sqrt{1 - 2 \ae\alpha + \alpha^2 L^2}$
		\end{theorem*}
	\subsection*{Метод скорейшего спуска}
	$\alpha_k = \text{Argmin}_{\alpha \geq 0} J(u_k - \alpha J'(u_k))$. 
	\begin{sample}
		$J(u) = \|u\|^2$, $J'(u) = 2 u$. Пусть $u_0 \in H$, тогда $ u_1 = u_0 - \alpha J'(u_0) = u_0 - 2 \alpha u_0 = (1- 2\alpha) u_0$. $J(u_0 - \alpha J'(u_0)) = \|(1- 2\alpha )u_0)\|^2 = (1-2\alpha)^2 \|u_0\|^2 \Rightarrow \alpha_0 = \dfrac12$
	\end{sample}
\section{Метод Ньютона. Его сходимость}
	Решение задачи условной минимизации: $J(u) \to \inf_{u\in U}, \ U \neq H$. \newline
	Идея: Пусть уже известно k-ое приближение $u_k \in U$. Берем квадратичную часть приращения $J(u) - J(u_k) = J_k(u) + \overline{o}(\|u- u_k\|^2)$, где $J_k(u) = (J'(u_k), u - u_k) + \dfrac12 (J''(u_k)(u-u_k), u-u_k), \ u\in U$. И вычисляем $u_{k+1} = \text{Argmin}_{u\in U} J_k(u)$
	
	\begin{theorem}
		(О сходимости метода Ньютона)\newline
		Пусть U - выпуклое замкнутое множество, $\text{int} U \neq \emptyset$, $J(u)$ сильно выпукла с константой $\ae >0$ на $U$, $J(u) \in C^2(U)$, $J''(u)$ удовлетворяет на $U$ условию Липшица с константой $L> 0$. Пусть начальное приближение удовлетворяет условию $\|u_0 - u_*\| < \dfrac{2\ae}{L}$, $u_*$ -решение задачи и $(J''(u) \xi, \xi) \geq \ae \|\xi\|^2$. Тогда метода Ньютона порождает последовательность $\{u_k\}:\ \|u_k - u_*\| \leq \dfrac{2\ae}{L}q^{2^k}$, $q = \dfrac{L \|u_0 -u_*\|}{2\ae} < 1$
	\end{theorem}
\section{Метод покоординатного спуска}
	В предыдущих методов нам требовалось вычислять градиент и гессиан функционала, но зачастую функционал не обладает нужной гладкостью. Рассмотрим этот метод для задаче минимизации без ограничений в конечномерном пространстве $J(u) \to \inf_{u\in \mathbb{R}^n}$. $\{e_i\}_{i=1}^{i=n}$ - базис. В дальнейшем будет использоваться бесконечный базис, поэтом доопределим $p_0 = e_1, p_1 = e_2, \dots, p_{n-1} = e_n, p_n = e_1, \dots, p_{2n-1}= e_n, \dots$ (циклически повторяются). \newline
	Перед запуском метода выбираем $u_0 \in \mathbb{R}^n$, стартовый шаг $\alpha_0 > 0$ и коэффициент дробления шага $\lambda \in (0,1)$. Пусть найдено k-е приближение $u_k$ и текущее значение шага $\alpha_k > 0$. Найдем следующее приближение. Вычислим $u = u_k + \alpha_k p_k$
	\begin{enumerate}
		\item Если $J(u_k + \alpha_k p_k) < J(u_k)$, то $u_{k+1} = u_k + \alpha_k p_k$, $\alpha_{k+1} = \alpha_k$ и процесс продолжается со следующим по порядку базисным направлением $p_{k+1}$. 
			\item Если $J(u_k - \alpha_k p_k) < J(u_k)$, то $u_{k+1} = u_k - \alpha_k p_k$, $\alpha_{k+1} = \alpha_k$ и процесс продолжается со следующим по порядку базисным направлением $p_{k+1}$. Будем называть $k+1$-ую итерацию удачной, если переход от $u_k$ к $u_{k+1}$ произошёл по этому или предыдущему пункту.
		\item Если $J(u_k + \alpha_k p_k) \geq J(u_k)$, то итерация неудачная. В процессе вычислений ведётся подсчёт числа неудачных итераций, случившихся подряд. Если их число вместе с текущей не достигло $n$, то полагают $u_{k+1} = u_k$, $\alpha_{k+1} = \alpha_k$ и переходят к следующему базисному направлению. Иначе происходит дробление шага $\alpha_k$ с коэффициентом $\lambda: \alpha_{k+1} = \lambda \alpha_k$.
	\end{enumerate}
	\begin{theorem}
		(о сходимости МПС)  \newline
		Пусть $J(u)$ выпуклый, $J(u) \in C^1(\mathbb{R}^n)$, $u_0$ -начальное приближение,  множество Лебега $M_{J(u_0)} = \{u \in \mathbb{R}^n \vert J(u) \leq J(u_0)\}$ ограниченно. Тогда $\lim\limits_{k\to\infty} J(u_k) = J_*, \lim\limits_{k\to\infty} \rho(u_k, u_*) = 0$.		
	\end{theorem}
	\begin{sample}
		$J\in C^1(\mathbb{R}^n)$ - существенно. $J(u) = (x-1)^2 + (y-1)^2 + 2 |x-y| -2$. $J_* = -2$, $U_* = \{(1,1)\}$. Функционал не дифференцируем в $x=y$. Пусть $u_0 = (0,0)$, тогда все $u_k = (0,0)$. Все шаги неудачные. 
	\end{sample}
\section{Метод штрафных функций и его сходимость}
	Позволяет решать задачи с большим количеством ограничений. Нарушая эти ограничения получаем "штрафы". \newline
	$H$ - гильбретово, $J(u) \to \inf_{u\in U}, U\subset H$, $U = \{u \in U_0 \vert g_1(u) \leq 0, \dots, g_m(u) \leq 0, g_{m+1}(u) =0, \dots g_{m+s}(u) = 0\}$ Функции $g_j$ как раз задают ограничения. Неструктурированные ограничения, задаываемые множеством $U_0$ считаем "терпимыми" и обязуемся их не нарушать. \newline
	Будем использовать одни из самых распространённых штрафов: за нарушение неравенств будем применять индивидуальные штрафы типа срезки: $g_i^+ (u) = max{g_i(u), 0}$. За нарушения равенств будетм испльзовать модули $g_i^+ = |g_i(u)|$. Из индивидуальных штрафов собирается общий $P(u) = \sum\limits_{i=1}^{m+s} (g_i^+(u))^{P_i}, \ P_i \geq 1, \ i =\overline{1, m+s}$\newline
	Свойства штрафов:
	\begin{enumerate}
		\item $P(u) \geq 0$
		\item $u\in U \Leftrightarrow \begin{cases} u\in U_0 \\ P(u) = 0 \end{cases} \Leftrightarrow \begin{cases} u\in U_0 \\ g_i^+(u) = 0 , i = \overline{1, m+s}\end{cases}$
		
	\end{enumerate}
	Общий штраф добавляется к исходному функционалу $J(u)$ и получаем следующую задачу: 
	\begin{equation*}
		\Phi_k(u) = J(u) + A_kP(u) \to \inf_{u \in U_0}
	\end{equation*}
	Задача на терпимом множестве. $\Phi_{k*} = \inf\limits_{u\in U_0} \Phi_k(u) \leq \Phi_k(u_k) \leq \Phi_{k*} + \varepsilon_k, \ \varepsilon_k > 0$. 
	\begin{definition}
		$\{P_k(u)\}$ - штрафная функция множества $U$ на множестве $U_0$, если
		\begin{enumerate}
			\item $P_k(u)$ определена на $U_0$ и неотрицательна на $U_0$
			\item $\lim\limits_{k\to\infty} P_k(u) = \begin{cases}
				0, u\in U\\
				+\infty, u \in U_0 \backslash U
			\end{cases}$
		\end{enumerate}
	\end{definition}
	
	\begin{theorem*}
		(Теорема о сходимости МШФ)\newline
		Пусть H-гильбертово пространство, множество $U_0 \subset H$ слабо замкнут в $H$, исходная функция $J(u)$ и все индивидуальные штрафы $g_i^+(u)$ слабо полунепрерывны снизу на $U_0$. Пусть также нижняя грань $J(u)$ на $U_0$ конечна, а $\delta$ - расширение $U(\delta) = \{u\in U_0 \vert g_i^+(u) \leq \delta , i =\overline{1, m+s}\}$ допустимого множества  $U$ при некотором $\delta$. Тогда если $A_k \to +\infty$ и $ \varepsilon_k \to 0$, то для элементов $u_k$ имеет место сходимость по функционалу $J(u_k) \to J_*$, а у самой последовательности $\{u_k\}_{k=1}^\infty$ имеется слабый в H предльные точки, причем каждая из них принадлежит $U_*$. 
	\end{theorem*}
	\begin{sample}
		$J(u) = x^2 + xy + y^2  \to \inf$, $U = \{u \in \mathbb{R}^2 \vert x+y=2\}$, $J_* =3$, $u* = (1,1)$. \newline
		$\Phi_k(u) = J(u) + A_kP(u) = x^2 +xy+y^2 + k (|x+y-2)^2, k \in \mathbb{N}$. \newline
		$\Phi_k'(u) = 0 \Rightarrow \left(\begin{matrix}
			2x+y+2k(x+y-2)\\
			x+2y+2k(x+y-2)
		\end{matrix}\right) = \left(\begin{matrix}
		0\\ 0
		\end{matrix}\right)$\newline
		$u_k =(x_k, y_k): \ x_k= y_k= \dfrac{4k}{3+4k}\to 1$ $u_* = (1,1)$.
	\end{sample}
\section{Правило множителей Лагранжа}
 	Та же задача, что и в предыдущем пункте. \newline
 	Введём функцию Лагранжа $L(u, \lambda) = \lambda_0 J(u) + \sum\limits_{i=1}^s \lambda_j g_j(u), \ u \in U_0, \lambda = (\lambda_0, \dots, \lambda_s), \lambda_j \geq 0$. 
 	
	\begin{theorem}
		(Правило множителей Лагранжа)\newline
		Пусть $U_0$ - выпуклое замкнутое множество, $u_* \in U$ - точка локального минимума $J(u)$. $g_i(u)$ - непрерывно дифференцируемы в окрестности $u_*$.Тогда $\exists \overline{\lambda^*} = (\lambda_0^*, \dots, \lambda_s^*): ,  \overline{\lambda^*} \neq 0$. $\lambda_j \geq 0, j = \overline{0,m}$. $(\dfrac{dL}{du}(u_*,  \overline{\lambda^*}) , u - u_*) \geq 0, \forall u \in U_0, \ \lambda_j^*g_j(u_*) = 0, j = \overline{1, m}$. L - выпукла по $u$. Тогда $u_* \in \text{Agrmin }_{u \in U_0} L(u,  \overline{\lambda^*})$
	\end{theorem}
\section{Теорема Куна-Такера}
	Задача как в предыдущем билете. \newline
		Введём функцию Лагранжа $L(u, \lambda) = \lambda_0 J(u) + \sum\limits_{i=1}^s \lambda_j g_j(u), \ u \in U_0, \lambda = (\lambda_0, \dots, \lambda_s), \lambda_j \geq 0$. И возьмём $\lambda_0 = 1$.  \newline
		$\Lambda_0 = \{\lambda = (\lambda_1, \dots, \lambda_s) \vert \lambda_1 \geq 0, \dots , \lambda_m \geq 0\}$
	\begin{definition}
		Точку $(u_*, \lambda^*) \in U_0 \times \Lambda_0$ называют седловой точкой функции Лагранжа, если $L(u_*, \lambda) \leq L(u_*, \lambda^*) \leq L(u, \lambda^*), \ \forall u \in U_0, \forall \lambda \in \Lambda_0$.
	\end{definition}
	\begin{theorem}
		(достаточное услоиве оптимальности)\newline
		Пусть функции $J(u), g_i(u), i=\overline{1,s}$ определены и конечны на $U_0$. Пусть $(u_*, \lambda^*)$ - седловая точка функции $L(u, \lambda)$. Тогда $u_* \in U_*$, $J(u_*) = J_* = L(u_*, \lambda^*)$.	
	\end{theorem}
\end{document}
